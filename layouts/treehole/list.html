{{- define "main" -}}
<header class="page-header">
  <h1>{{ .Title }}</h1>
  {{- with .Content -}}
  <div class="post-content">
    {{ . }}
  </div>
  {{- end -}}
</header>

{{- $pages := where .Pages "Params.draft" "!=" true -}}
{{- if not $pages -}}
<p>暂无内容。</p>
{{- else -}}
  {{- range $pages.ByDate.Reverse -}}
  {{- $kind := .Params.treeholeType | default "note" -}}
  <article class="treehole-card {{ if eq $kind "quote" }}treehole-card--quote{{ end }}">
    {{- if ne $kind "quote" -}}
    <header class="treehole-card__header">
      {{- if .Title -}}
      <h2 class="treehole-card__title">
        <a href="{{ .RelPermalink }}">{{ .Title }}</a>
      </h2>
      {{- end -}}
      <div class="treehole-card__meta">{{ .Date.Format "2006-01-02" }}</div>
    </header>
    {{- end -}}

    {{- if eq $kind "quote" -}}
      {{- $style := .Params.quoteStyle | default "paper" -}}
      <a href="{{ .RelPermalink }}" class="treehole-quote treehole-quote--{{ $style }}">
        {{- if ne $style "literary" -}}
        <div class="treehole-quote__date">{{ .Date.Format "2006-01-02" }}</div>
        {{- end -}}
        <div class="treehole-quote__body">
          {{ .Params.quote | default .Summary | markdownify }}
        </div>
        {{- if or .Params.quoteAuthor .Params.quoteSource (eq $style "literary") -}}
        <div class="treehole-quote__meta">
          {{- with .Params.quoteAuthor -}}
          <div class="treehole-quote__author">— {{ . }}</div>
          {{- end -}}
          {{- with .Params.quoteSource -}}
          <div class="treehole-quote__source">{{ . }}</div>
          {{- end -}}
          {{- if eq $style "literary" -}}
          <div class="treehole-quote__date">{{ .Date.Format "2006-01-02" }}</div>
          {{- end -}}
        </div>
        {{- end -}}
      </a>
    {{- else -}}
      <div class="treehole-note">
        {{ .Summary | markdownify }}
      </div>
    {{- end -}}
  </article>
  {{- end -}}
{{- end -}}
{{- end -}}
